name: SSH
on:
  workflow_dispatch:

jobs:
  SSH:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v3

      - name: Install dependencies
        run: |
          sudo apt-get update
          sudo apt-get install -y openssh-server
      - name: Start SSH service
        run: |
          sudo systemctl enable ssh
          sudo systemctl start ssh

          echo "Server kernel info:"
          uname -a

          echo "Server IP Address:"
          ip addr show | grep 'inet ' | awk '{print $2}' | cut -d'/' -f1

          echo "SSH Port:"
          sudo ss -tnl | grep ssh | awk '{print $4}' | cut -d':' -f2

          echo "Public Key for SSH Key Authentication:"
          cat ~/.ssh/id_rsa.pub

          echo "Copy the public key above to the remote machine's authorized_keys file."
          echo "Now you can connect using:"
          echo "ssh <username>@<server_ip> -p <ssh_port>"
